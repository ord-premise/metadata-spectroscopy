{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "$id": "https://example.com/afm.schema.json",
    "title": "AFM",
    "description": "An AFM",
    "type": "object",
    "properties": {
        "name": {
            "type": "string",
            "description": "The name of the AFM."
        },
        "recordingTime": {
            "type": "string",
            "description": "The date of the AFM.",
            "format": "date-time"
        },
        "duration": {
            "type": "object",
            "description": "The duration of the AFM.",
            "properties": {
                "value": {
                    "type": "number"
                },
                "unit": {
                    "type": "string"
                }
            }
        },
        "biasSettings": {
            "type": "object",
            "description": "Bias voltage settings.",
            "properties": {
                "setpoint": {
                    "type": "object",
                    "description": "Setpoint",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                },
                "calibrationFactor": {
                    "type": "object",
                    "description": "Calibration factor",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                },
                "calibrationOffset": {
                    "type": "object",
                    "description": "Calibration offset",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                }
            }
        },
        "currentSettings": {
            "type": "object",
            "description": "Current settings.",
            "properties": {
                "setpoint": {
                    "type": "object",
                    "description": "Setpoint",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                },
                "calibrationFactor": {
                    "type": "object",
                    "description": "Calibration factor",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                },
                "calibrationOffset": {
                    "type": "object",
                    "description": "Calibration offset",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                },
                "gain": {
                    "type": "number",
                    "description": "Gain"
                }
            }
        },
        "Z": {
            "type": "object",
            "description": "Tip position in Z axis",
            "properties": {
                "value": {
                    "type": "number"
                },
                "unit": {
                    "type": "string"
                }
            }
        },
        "feedbackSettings": {
            "type": "object",
            "description": "Feedback settings.",
            "properties": {
                "feedbackActive": {
                    "type": "string",
                    "description": "Whether feedback is active",
                    "enum": ["active", "inactive"]
                },
                "feedbackType": {
                    "type": "string",
                    "description": "Feedback type",
                    "enum": ["Log current", "Abs current"]
                }
            }
        },
        "ZControllerSettings": {
            "type": "object",
            "description": "Z-Controller settings.",
            "properties": {
                "setpoint": {
                    "type": "object",
                    "description": "Setpoint",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                },
                "pGain": {
                    "type": "number",
                    "description": "Proportional gain"
                },
                "iGain": {
                    "type": "number",
                    "description": "Integral gain"
                },
                "timeConstant": {
                    "type": "object",
                    "description": "Time constant",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                },
                "tipLift": {
                    "type": "object",
                    "description": "Position of the tip when feedback loop is off",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                },
                "switchOffDelay": {
                    "type": "object",
                    "description": "Time delay applied when switching off feedback loop",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                }
            }
        },
        "piezoConfigurationSettings": {
            "type": "object",
            "description": "Piezo configuration settings.",
            "properties": {
                "activeCalib": {
                    "type": "object",
                    "description": "Setpoint",
                    "enum": ["LHe"]
                },
                "sensitivity": {
                    "type": "object",
                    "description": "Sensitivity",
                    "properties": {
                        "x": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "y": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "z": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                },
                "HVGain": {
                    "type": "object",
                    "description": "HV Gain",
                    "properties": {
                        "x": {
                            "type": "number"
                        },
                        "y": {
                            "type": "number"
                        },
                        "z": {
                            "type": "number"
                        }
                    }
                },
                "scanSlope": {
                    "type": "object",
                    "description": "Scan slope",
                    "properties": {
                        "x": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "y": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                },
                "curvatureRadius": {
                    "type": "object",
                    "description": "Curvature radius",
                    "properties": {
                        "x": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "y": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                },
                "secondOrderCorrection": {
                    "type": "object",
                    "description": "2nd order correction",
                    "properties": {
                        "x": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "y": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                },
                "drift": {
                    "type": "object",
                    "description": "Drift",
                    "properties": {
                        "x": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "y": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "z": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                },
                "driftCorrectionStatus": {
                    "type": "boolean",
                    "description": "Whether the drift correction is performed."
                }
            }
        },
        "scanSettings": {
            "type": "object",
            "description": "Scan settings",
            "properties": {
                "field": {
                    "type": "array",
                    "items": {
                        "type": "number"
                    },
                    "description": "The scanfield of the image."
                },
                "angle": {
                    "type": "object",
                    "description": "Angle",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                },
                "offset": {
                    "type": "object",
                    "description": "Offset",
                    "properties": {
                        "x": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "y": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                },
                "time": {
                    "type": "object",
                    "description": "Time",
                    "properties": {
                        "x": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "y": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                },
                "range": {
                    "type": "object",
                    "description": "Range",
                    "properties": {
                        "x": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "y": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                },
                "pixels": {
                    "type": "object",
                    "description": "Pixels",
                    "properties": {
                        "x": {
                            "type": "number"
                        },
                        "y": {
                            "type": "number"
                        }
                    }
                },
                "speed": {
                    "type": "object",
                    "description": "Speed",
                    "properties": {
                        "forward": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "backwards": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                },
                "direction": {
                    "type": "string",
                    "description": "Direction.",
                    "enum": ["down", "both"]
                }
            }
        },
        "dwellTime": {
            "type": "Acquisition time for each point value in data",
            "properties": {
                "value": {
                    "type": "number"
                },
                "unit": {
                    "type": "string"
                }
            }
        },
        "sampleTemperature": {
            "type": "Sample temperature",
            "properties": {
                "value": {
                    "type": "number"
                },
                "unit": {
                    "type": "string"
                }
            }
        },
        "recordingTemperature": {
            "type": "Room temperature",
            "properties": {
                "value": {
                    "type": "number"
                },
                "unit": {
                    "type": "string"
                }
            }
        },
        "oscillationControlSettings": {
            "type": "object",
            "description": "Oscillation control settings.",
            "properties": {
                "differentialInput": {
                    "type": "boolean",
                    "description": "Whether differential input is used."
                },
                "oneTen": {
                    "type": "boolean",
                    "description": "Whether the input is attenuated by a factor of 10."
                },
                "inputCalibration": {
                    "type": "object",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                },
                "inputRange": {
                    "type": "object",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                },
                "centerFrequency": {
                    "type": "object",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                },
                "range": {
                    "type": "object",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                },
                "demodulationSettings": {
                    "type": "object",
                    "description": "Demodulation settings.",
                    "properties": {
                        "inputs": {
                            "type": "array",
                            "items": {
                                "type": "number"
                            }
                        },
                        "frequencies": {
                            "type": "array",
                            "items": {
                                "type": "object",
                                "properties": {
                                    "value": {
                                        "type": "number"
                                    },
                                    "unit": {
                                        "type": "string"
                                    }
                                }
                            }
                        },
                        "referencePhases": {
                            "type": "array",
                            "items": {
                                "type": "object",
                                "properties": {
                                    "value": {
                                        "type": "number"
                                    },
                                    "unit": {
                                        "type": "string"
                                    }
                                }
                            }
                        },
                        "cutoffFrequencies": {
                            "type": "array",
                            "items": {
                                "type": "object",
                                "properties": {
                                    "value": {
                                        "type": "number"
                                    },
                                    "unit": {
                                        "type": "string"
                                    }
                                }
                            }
                        },
                        "harmonics": {
                            "type": "array",
                            "items": {
                                "type": "object",
                                "properties": {
                                    "value": {
                                        "type": "number"
                                    },
                                    "unit": {
                                        "type": "string"
                                    }
                                }
                            }
                        },
                        "filtersOrders": {
                            "type": "array",
                            "items": {
                                "type": "number"
                            }
                        }
                    }
                },
                "phaseSettings": {
                    "type": "object",
                    "description": "Phase settings.",
                    "properties": {
                        "pGain": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "iGain": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "controllerOn": {
                            "type": "boolean",
                            "description": "Whether the phase controller is on."
                        }
                    }
                },
                "frequencyShift": {
                    "type": "object",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                },
                "amplitudeSettings": {
                    "type": "object",
                    "description": "Amplitude settings.",
                    "properties": {
                        "setpoint": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "pGain": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "iGain": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "controllerOn": {
                            "type": "boolean",
                            "description": "Whether the amplitude controller is on."
                        }
                    }
                },
                "excitation": {
                    "type": "object",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                },
                "outputSettings": {
                    "type": "object",
                    "description": "Output settings.",
                    "properties": {
                        "amplitudeRange": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "active": {
                            "type": "boolean",
                            "description": "Whether the output is on.",
                            "enum": ["active", "inactive"]
                        },
                        "add": {
                            "type": "boolean",
                            "description": "Whether to add the signal at the ADD connector of the OC4 to the output signal.",
                            "enum": ["active", "inactive"]
                        }
                    }
                },
                "PLLSetupSettings": {
                    "type": "object",
                    "description": "PLL setup settings.",
                    "properties": {
                        "qFactor": {
                            "type": "number",
                            "description": "Q-factor."
                        },
                        "demodulationBWAmp": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            },
                            "description": "Demodulation bandwidth of the amplitude controller"
                        },
                        "demodulationBWPha": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            },
                            "description": "Demodulation bandwidth of the phase controller"
                        },
                        "amplitudeExcitationRatio": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            },
                            "description": "Amplitude to excitation ratio at the resonance"
                        }
                    }
                }
            }
        },
        "comments": {
            "type": "string",
            "description": "Comments to the AFM."
        },
        "scandx": {
            "type": "object",
            "description": "Increment in x and y (ask whether it is used for z)",
            "properties": {
                "value": {
                    "type": "number"
                },
                "unit": {
                    "type": "string"
                }
            }
        },
        "scanZMin": {
            "type": "object",
            "description": "Minimum distance between the probe particle and the substract",
            "properties": {
                "value": {
                    "type": "number"
                },
                "unit": {
                    "type": "string"
                }
            }
        },
        "scanZMax": {
            "type": "object",
            "description": "Maximum distance between the probe particle and the substract",
            "properties": {
                "value": {
                    "type": "number"
                },
                "unit": {
                    "type": "string"
                }
            }
        },
        "amplitude": {
            "type": "object",
            "description": "Amplitude",
            "properties": {
                "value": {
                    "type": "number"
                },
                "unit": {
                    "type": "string"
                }
            }
        },
        "resonanceFrequency": {
            "type": "Resonance frequency",
            "properties": {
                "value": {
                    "type": "number"
                },
                "unit": {
                    "type": "string"
                }
            }
        },
        "pModel": {
            "type": "string",
            "description": "Type of the theory approximation (single probe, 2PP RESP PTCTA, 2PP RESP pentacene).",
            "enum": ["Single probe", "2PP RESP PTCTA", "2PP RESP pentacene"]
        },
        "simulation": {
            "$ref": "./simulation.schema.json",
            "description": "Details about the simulation"
        },
        "annealing": {
            "$ref": "./annealing.schema.json",
            "description": "Details about the annealing before the AFM"
        },
        "deposition": {
            "$ref": "./deposition.schema.json",
            "description": "Details about the deposition before the AFM"
        },
        "dft": {
            "$ref": "./dft.schema.json",
            "description": "Details about the DFT parameters"
        },
        "tb": {
            "$ref": "./tb.schema.json",
            "description": "Details about the TB parameters"
        },
        "required": ["name", "recordingTime", "duration", "biasSettings", "currentSettings", "Z"]
    }
}