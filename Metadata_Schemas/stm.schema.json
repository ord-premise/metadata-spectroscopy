{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "$id": "https://example.com/stm.schema.json",
    "title": "STM",
    "description": "An STM",
    "type": "object",
    "properties": {
        "name": {
            "type": "string",
            "description": "The name of the STM."
        },
        "recordingTime": {
            "type": "string",
            "description": "The date of the STM.",
            "format": "date-time"
        },
        "duration": {
            "type": "object",
            "description": "The duration of the STM.",
            "properties": {
                "value": {
                    "type": "number"
                },
                "unit": {
                    "type": "string"
                }
            }
        },
        "biasSettings": {
            "type": "object",
            "description": "Bias voltage settings.",
            "properties": {
                "setpoint": {
                    "type": "object",
                    "description": "Setpoint",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                },
                "calibrationFactor": {
                    "type": "object",
                    "description": "Calibration factor",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                },
                "calibrationOffset": {
                    "type": "object",
                    "description": "Calibration offset",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                }
            }
        },
        "currentSettings": {
            "type": "object",
            "description": "Current settings.",
            "properties": {
                "setpoint": {
                    "type": "object",
                    "description": "Setpoint",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                },
                "calibrationFactor": {
                    "type": "object",
                    "description": "Calibration factor",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                },
                "calibrationOffset": {
                    "type": "object",
                    "description": "Calibration offset",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                },
                "gain": {
                    "type": "number",
                    "description": "Gain"
                }
            }
        },
        "Z": {
            "type": "object",
            "description": "Tip position in Z axis",
            "properties": {
                "value": {
                    "type": "number"
                },
                "unit": {
                    "type": "string"
                }
            }
        },
        "feedbackSettings": {
            "type": "object",
            "description": "Feedback settings.",
            "properties": {
                "feedbackActive": {
                    "type": "string",
                    "description": "Whether feedback is active",
                    "enum": ["active", "inactive"]
                },
                "feedbackType": {
                    "type": "string",
                    "description": "Feedback type",
                    "enum": ["Log current", "Abs current"]
                }
            }
        },
        "ZControllerSettings": {
            "type": "object",
            "description": "Z-Controller settings.",
            "properties": {
                "setpoint": {
                    "type": "object",
                    "description": "Setpoint",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                },
                "pGain": {
                    "type": "number",
                    "description": "Proportional gain"
                },
                "iGain": {
                    "type": "number",
                    "description": "Integral gain"
                },
                "timeConstant": {
                    "type": "object",
                    "description": "Time constant",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                },
                "tipLift": {
                    "type": "object",
                    "description": "Position of the tip when feedback loop is off",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                },
                "switchOffDelay": {
                    "type": "object",
                    "description": "Time delay applied when switching off feedback loop",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                }
            }
        },
        "piezoConfigurationSettings": {
            "type": "object",
            "description": "Piezo configuration settings.",
            "properties": {
                "activeCalib": {
                    "type": "string",
                    "description": "Setpoint",
                    "enum": ["LHe"]
                },
                "sensitivity": {
                    "type": "object",
                    "description": "Sensitivity",
                    "properties": {
                        "x": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "y": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "z": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                },
                "HVGain": {
                    "type": "object",
                    "description": "HV Gain",
                    "properties": {
                        "x": {
                            "type": "number"
                        },
                        "y": {
                            "type": "number"
                        },
                        "z": {
                            "type": "number"
                        }
                    }
                },
                "scanSlope": {
                    "type": "object",
                    "description": "Scan slope",
                    "properties": {
                        "x": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "y": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                },
                "curvatureRadius": {
                    "type": "object",
                    "description": "Curvature radius",
                    "properties": {
                        "x": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "y": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                },
                "secondOrderCorrection": {
                    "type": "object",
                    "description": "2nd order correction",
                    "properties": {
                        "x": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "y": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                },
                "drift": {
                    "type": "object",
                    "description": "Drift",
                    "properties": {
                        "x": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "y": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "z": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                },
                "driftCorrectionStatus": {
                    "type": "boolean",
                    "description": "Whether the drift correction is performed."
                }
            }
        },
        "scanSettings": {
            "type": "object",
            "description": "Scan settings",
            "properties": {
                "field": {
                    "type": "array",
                    "items": {
                        "type": "number"
                    },
                    "description": "The scanfield of the image."
                },
                "angle": {
                    "type": "object",
                    "description": "Angle",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                },
                "offset": {
                    "type": "object",
                    "description": "Offset",
                    "properties": {
                        "x": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "y": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                },
                "time": {
                    "type": "object",
                    "description": "Time",
                    "properties": {
                        "x": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "y": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                },
                "range": {
                    "type": "object",
                    "description": "Range",
                    "properties": {
                        "x": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "y": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                },
                "pixels": {
                    "type": "object",
                    "description": "Pixels",
                    "properties": {
                        "x": {
                            "type": "number"
                        },
                        "y": {
                            "type": "number"
                        }
                    }
                },
                "speed": {
                    "type": "object",
                    "description": "Speed",
                    "properties": {
                        "forward": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "backwards": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                },
                "direction": {
                    "type": "string",
                    "description": "Direction.",
                    "enum": ["down", "both"]
                }
            }
        },
        "dwellTime": {
            "type": "Acquisition time for each point value in data",
            "properties": {
                "value": {
                    "type": "number"
                },
                "unit": {
                    "type": "string"
                }
            }
        },
        "sampleTemperature": {
            "type": "Sample temperature",
            "properties": {
                "value": {
                    "type": "number"
                },
                "unit": {
                    "type": "string"
                }
            }
        },
        "recordingTemperature": {
            "type": "Room temperature",
            "properties": {
                "value": {
                    "type": "number"
                },
                "unit": {
                    "type": "string"
                }
            }
        },
        "eMin": {
            "type": "Energy of the lowest orbital included in the calculation",
            "properties": {
                "value": {
                    "type": "number"
                },
                "unit": {
                    "type": "string"
                }
            }
        },
        "eMax": {
            "type": "Energy of the highest orbital included in the calculation",
            "properties": {
                "value": {
                    "type": "number"
                },
                "unit": {
                    "type": "string"
                }
            }
        },
        "dE": {
            "type": "Step between the eMin and eMax",
            "properties": {
                "value": {
                    "type": "number"
                },
                "unit": {
                    "type": "string"
                }
            }
        },
        "FWHM": {
            "type": "Full width at half maximum",
            "properties": {
                "value": {
                    "type": "number"
                },
                "unit": {
                    "type": "string"
                }
            }
        },
        "extrapPlane": {
            "type": "Position of the extrapolation place",
            "properties": {
                "value": {
                    "type": "number"
                },
                "unit": {
                    "type": "string"
                }
            }
        },
        "constantHeight": {
            "type": "Distance from the surface at which the constant Z image is simulated",
            "properties": {
                "value": {
                    "type": "number"
                },
                "unit": {
                    "type": "string"
                }
            }
        },
        "constantCurrent": {
            "type": "Isovalue of charged density at which the constant current image is produced",
            "properties": {
                "value": {
                    "type": "number"
                },
                "unit": {
                    "type": "string"
                }
            }
        },
        "comments": {
            "type": "string",
            "description": "Comments to the STM."
        },
        "simulation": {
            "$ref": "./simulation.schema.json",
            "description": "Details about the simulation"
        },
        "annealing": {
            "$ref": "./annealing.schema.json",
            "description": "Details about the annealing before the STM"
        },
        "deposition": {
            "$ref": "./deposition.schema.json",
            "description": "Details about the deposition before the STM"
        },
        "dft": {
            "$ref": "./dft.schema.json",
            "description": "Details about the DFT parameters"
        },
        "tb": {
            "$ref": "./tb.schema.json",
            "description": "Details about the TB parameters"
        },
        "required": ["name", "recordingTime", "duration", "biasSettings", "currentSettings", "Z"]
    }
}